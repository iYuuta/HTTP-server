<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Webserver Test Panel</title>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    section { border: 1px solid #ccc; padding: 20px; margin-bottom: 30px; border-radius: 8px; }
    h2 { color: #333; }
    label { display: block; margin: 8px 0 4px; }
    input, textarea, select { width: 100%; max-width: 400px; padding: 8px; }
    button { margin-top: 10px; padding: 8px 16px; }
  </style>
</head>
<body>
  <h1>Webserver Functionality Test</h1>

  <!-- GET Request -->
  <section>
    <h2>GET Request Test</h2>
    <form action="/images/image1.jpg" method="get">
      <button type="submit">GET /images/image1.jpg</button>
    </form>
  </section>

  <!-- POST to CGI -->
  <section>
    <h2>POST to CGI</h2>

    <!-- Select CGI Script -->
    <form id="cgiForm" method="post">
      <label for="cgi-script">Choose CGI script:</label>
      <select id="cgi-script" onchange="updateAction()">
        <option value="/cgi-bin/python-cgi.py">python-cgi.py</option>
        <option value="/cgi-bin/bash-cgi.sh">bash-cgi.sh</option>
        <option value="/cgi-bin/php-cgi.php">php-cgi.php</option>
      </select>

      <label for="name">Name:</label>
      <input type="text" name="name" required>

      <label for="message">Message:</label>
      <textarea name="message" rows="4"></textarea>

      <button type="submit">POST to CGI</button>
    </form>
  </section>

  <!-- File Upload to /uploads -->
  <section>
    <h2>Upload File to /uploads</h2>
    <form action="/uploads" method="post" enctype="multipart/form-data">
      <label for="file">Choose a file:</label>
      <input type="file" name="file" id="file">
      <button type="submit">Upload</button>
    </form>
  </section>

  <!-- DELETE Request via JS -->
  <section>
    <h2>DELETE Request to /uploads</h2>
    <label for="delPath">File to delete (relative to /uploads):</label>
    <input type="text" id="delPath" placeholder="example.txt" />
    <button onclick="sendDelete()">Send DELETE</button>
    <p id="deleteResult"></p>
  </section>

  <!-- Redirect Test -->
  <section>
    <h2>Redirect Test</h2>
    <form action="/redirect" method="get">
      <button type="submit">Go to /redirect</button>
    </form>
  </section>

  <script>
    function updateAction() {
      const select = document.getElementById("cgi-script");
      const form = document.getElementById("cgiForm");
      form.action = select.value;
    }

    async function sendDelete() {
      const file = document.getElementById('delPath').value;
      const result = document.getElementById('deleteResult');
      try {
        const res = await fetch(`/uploads/${file}`, { method: 'DELETE' });
        const text = await res.text();
        result.innerText = `Status: ${res.status}\n\n${text}`;
      } catch (e) {
        result.innerText = 'Error sending DELETE: ' + e.message;
      }
    }

    // Set initial action
    updateAction();
  </script>
</body>
</html>
